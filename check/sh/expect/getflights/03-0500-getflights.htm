<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
	<title>getflights &middot; debug output</title>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<meta name="author" content="Tobias Kühne">
</head>
<body>
<pre>
arrival
========

http://localhost/.../www.frankfurt-airport.com/de/_jcr_content.arrivals.json/filter?type=arrival&lang=de&time=0000-00-03T05%3A00%3A00%2B0100&perpage=3&page=1
{"type":"arrival","luops":"0000-00-03T05:00:00+0100","lusaison":"0000-00-03T05:00:00+0100","results":0,"entriesperpage":0,"maxpage":0,"page":0}

/************************************/

---------------------------
0 (0) Flüge gefunden.
    Dauer: 0.000s

===========================

departure
========

http://localhost/.../www.frankfurt-airport.com/de/_jcr_content.departures.json/filter?type=departure&lang=de&time=0000-00-03T05%3A00%3A00%2B0100&perpage=3&page=1
{"type":"departure","luops":"0000-00-03T05:00:00+0100","lusaison":"0000-00-03T05:00:00+0100","results":0,"entriesperpage":0,"maxpage":0,"page":0}

/************************************/

---------------------------
0 (0) Flüge gefunden.
    Dauer: 0.000s

===========================


INSERT INTO `watchlist-notifications`(`flight`, `watch`)  SELECT `flights`.`id`, `watchlist`.`id` FROM `watchlist` INNER JOIN `aircrafts` ON `aircrafts`.`reg` LIKE REPLACE(REPLACE(`watchlist`.`reg`, '*', '%'), '?', '_') INNER JOIN (SELECT `id`, `direction`, IFNULL(`expected`, `scheduled`) AS `expected`, `aircraft` FROM `flights` WHERE `aircraft` IS NOT NULL) AS `flights` ON `aircrafts`.`id` = `flights`.`aircraft` LEFT JOIN `watchlist-notifications` ON `watchlist-notifications`.`flight` = `flights`.`id` WHERE `watchlist`.`notify` = TRUE AND `watchlist-notifications`.`flight` IS NULL AND 'arrival' = `flights`.`direction` AND `expected` > '0000-00-03T05:00:00+0100' FOR UPDATE
SELECT `watchlist-notifications`.`id` AS `id`, UNIX_TIMESTAMP(IFNULL(`flights`.`expected`, `flights`.`scheduled`)) AS `expected`, CONCAT(`airlines`.`code`, `flights`.`code`) AS `flight`, `aircrafts`.`reg` AS `reg`, `watchlist`.`comment` AS `comment`, `users`.`name` AS `name`, `users`.`email` AS `email`, `users`.`notification-timefmt` AS `fmt`, `users`.`language` AS `lang` FROM `watchlist-notifications` LEFT JOIN `watchlist` ON `watchlist-notifications`.`watch` = `watchlist`.`id` LEFT JOIN `flights` ON `watchlist-notifications`.`flight` = `flights`.`id` LEFT JOIN `airlines` ON `flights`.`airline` = `airlines`.`id` LEFT JOIN `aircrafts` ON `flights`.`aircraft` = `aircrafts`.`id` LEFT JOIN `users` ON `watchlist`.`user` = `users`.`id` WHERE IFNULL(`flights`.`expected`, `flights`.`scheduled`) > '0000-00-03T05:00:00+0100' AND `notified` IS NULL AND FROM_UNIXTIME(0, '%H:%i:%s') BETWEEN `users`.`notification-from` AND `users`.`notification-until` ORDER BY `email` ASC, `expected` ASC
DELETE `watchlist-notifications` FROM `watchlist-notifications` INNER JOIN `flights` ON `flights`.`id`=`watchlist-notifications`.`flight` WHERE (DATEDIFF('0000-00-03T05:00:00+0100', IFNULL(`flights`.`expected`, `flights`.`scheduled`)) > 1)


=== fin. ===
</pre>
</body>
</html>
